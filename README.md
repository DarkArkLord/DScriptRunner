```
    ____  _____           _       __  ____                             
   / __ \/ ___/__________(_)___  / /_/ __ \__  ______  ____  ___  _____
  / / / /\__ \/ ___/ ___/ / __ \/ __/ /_/ / / / / __ \/ __ \/ _ \/ ___/
 / /_/ /___/ / /__/ /  / / /_/ / /_/ _, _/ /_/ / / / / / / /  __/ /    
/_____//____/\___/_/  /_/ .___/\__/_/ |_|\__,_/_/ /_/_/ /_/\___/_/     
                       /_/                                             
```

# DScriptRunner

DScriptRunner - это tray only приложение, предназначенное быть удобной точкой входа для запуска пользовательских PowerShell скриптов.

В запущенном состоянии приложение выглядит как иконка в трее (в нижнем правом углу Рабочего стола, или у правого края Панели задач, где отображаются часы и значки некоторых рабочих приложений). По нажатию правой кнопки мыши на значке приложения появляется контекстное меню, позволяющее:
- запустить пользовательские скрипты
- указать путь к файлу конфигурации
- перезагрузить конфигурацию
- закрыть приложение

# Технологии 

- Основа проекта - `.Net Core 3.1`
- Всплывающие уведомления - `Microsoft.Toolkit.Uwp.Notifications v7.1.2`
- Пользовательские скрипты - `PowerShell`

# Конфигурация

Конфигурирование приложения происходит путем модификации файла ScriptsConfig.xml, который при сборке приложения копируется в результирующую папку.

Основной тег конфигурации `Config` является обязательным и содержит следующие теги:
- `Global`  - **не обязательный**, отвечает за общие настройки приложения:
  - `Hello` - сообщение, выдаваемое приложением при завершении загрузки конфигурации _(пустое сообщение при отсутствии)_;
  - `Before` - общая часть, которая будет добавлена в начало каждого скрипта _(например, глобальные переменные; при отсутствии ничего не добавляется)_;
  - `After` - общая часть, которая будет добавлена в конец каждого скрипта _(например, пауза после исполнения; при отсутствии ничего не добавляется)_;
- `Scripts` - **обязательный**, отвечает за пользовательские скрипты:
  - `Script` - непосредственно содержит пользовательский код скрипта PowerShell;
  - `Group` - служит для группировки скриптов в подменю для удобства восприятия;

Теги `Script` и `Group` **должны** иметь атрибут `name` - название скрипта/группы в контекстном меню.

# Пример конфигурации

При использовании стандартного файла конфигурации приложение сработает следующим образом::

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Config>
    <Global>
        <Hello>
            Привет! Я готов к работе.
        </Hello>
        <Before>
            Write-Host "START"
        </Before>
        <After>
            Write-Host "END"
            pause
        </After>
    </Global>
    <Scripts>
        <Group name="Test1">
            <Group name="Test2">
                <Script name="Test2-Script">
                    Write-Host "TEST 3"
                </Script>
            </Group>
            <Script name="Test1-Script">
                Write-Host "TEST 2"
            </Script>
        </Group>
        <Script name="Test-Script">
            Write-Host "TEST 1"
        </Script>
    </Scripts>
</Config>
```

При окончании загрузки конфигурации будет выводиться сообщение `"Привет! Я готов к работе."`